<mat-card class="shipping-card">

  <!-- Dashboard Title -->


  <mat-card-content *ngIf="!selectedUser">
    <mat-card-header>
      <mat-card-title>Usuarios</mat-card-title>
    </mat-card-header>
    <mat-list>
      <mat-list-item *ngFor="let user of users; trackBy: trackByUserId">
        {{ user.first_name }} {{ user.last_name }}
        <span *ngIf="user.id === currentUserId" style="font-size:0.9em; margin-left:8px; color:#888;">(Yo)</span>
        <button mat-mini-fab color="accent" (click)="updateUser(user)" class="btn-actualizar"><i class="fa fa-search" aria-hidden="true"></i></button>
        <!-- We intentionally avoid showing a direct delete action in the list. Deletion is handled in the details view. -->
      </mat-list-item>
    </mat-list>
  </mat-card-content>


  <mat-card-header *ngIf="selectedUser">
    <mat-card-title>Información del usuario</mat-card-title>
  </mat-card-header>

  <mat-card-content id="formUpdate">
    <div *ngIf="selectedUser" class="edit-user-section">
      <div class="row">        
        <mat-form-field class="full-width">
          <mat-label>Nombre</mat-label>
          <input matInput [(ngModel)]="selectedUser.first_name" readonly >
        </mat-form-field>
      </div>

      <div class="row">        
        <mat-form-field class="full-width">
          <mat-label>Apellido</mat-label>
          <input matInput [(ngModel)]="selectedUser.last_name" readonly>
        </mat-form-field>
      </div>

      <div class="row">
        <mat-form-field class="full-width">
          <mat-label>Dirección</mat-label>
          <input matInput [(ngModel)]="selectedUser.address" readonly >
        </mat-form-field>
      </div>

      <div class="row">
        <mat-form-field class="full-width">
          <mat-label>Telefono</mat-label>
          <input matInput  [(ngModel)]="selectedUser.phone" readonly>
        </mat-form-field>
      </div>      

      <div class="row">
        <mat-form-field class="full-width">
          <mat-label>Correo electrónico</mat-label>
          <input matInput [(ngModel)]="selectedUser.email" readonly>
        </mat-form-field>
      </div>

      <div class="row">
        <mat-form-field class="full-width">
          <mat-label>Rol</mat-label>
          <mat-select [(ngModel)]="selectedUser.role_id" [disabled]="selectedUser && selectedUser.id === currentUserId">
            <mat-option *ngFor="let role of roles" [value]="role.id">
              {{ role.name }}
            </mat-option>
          </mat-select>         
        </mat-form-field>
      </div>

      <div class="row">
        <mat-slide-toggle mat-mini-fab color="accent" [(ngModel)]="selectedUser.active">Activo</mat-slide-toggle>
      </div>

      <mat-action-list>
        <button mat-raised-button color="accent" (click)="saveChanges()" class="mr-2">Guardar</button>
  <button mat-raised-button color="warn" (click)="deleteUser(selectedUser.id)" class="mr-2" [disabled]="selectedUser && selectedUser.id === currentUserId" matTooltip="No puedes eliminar tu propio usuario desde aquí">Eliminar</button>
        <button mat-raised-button (click)="cancelUpdate()">Volver</button>
      </mat-action-list>
      
    </div>
  </mat-card-content>

  
</mat-card>